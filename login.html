<!DOCTYPE html>
<html>
    <head>
        <title>Ogame</title>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

        
        <link rel="stylesheet" href="style/style.css">
        <link rel="stylesheet" href="style/general.css">
        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    </head>
    <body>

      <div class="wrapper">
        <form id="loginform" onsubmit="return false">
          <h1>Login</h1>
          <div class="input-box">
            <input id="username" type="text" placeholder="Username" required>
            <i class='bx bxs-user'></i>
          </div>
          <div class="input-box">
            <input id="password" type="password" placeholder="Password" required>
            <i class='bx bxs-lock-alt'></i>
          </div>

          <div class="remember-forgot">
            <label>
              <input id="remember" type="checkbox"> Remember me
            </label>
          </div>

          
          <input type="submit" value="Login" class="submit" class="btn" onclick="login()" >

          <div class="register-link">
            <p>Don't have an a account? <a href="http://127.0.0.1:5500/register.html">Register</a></p>
          </div>
        </form>
      </div>
    </body>
    <script>

      var userNameField = document.getElementById("username");
      var passwordField = document.getElementById("password");


      function startLogin()
      {
        //login();
        return false;
      }

      async function login()
      {
        var username = userNameField.value;
        var password = passwordField.value;

        const response = await fetch(`http://127.0.0.1:8080/login?username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`);
        var data = await response.json();

        if(data.success)
        {
          alert("Dobro dosli " + data.username);

          localStorage.setItem("OG.username", data.username);
          localStorage.setItem("OG.token", data.token);
          localStorage.setItem("OG.planets", data.ownedPlanets);

          location.href = 'http://127.0.0.1:5500/ogame.html';
        }
        else
        {
          alert("Neuspijesna prijava!");
        }
      }

    </script>
</html>