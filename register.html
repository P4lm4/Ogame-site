<!DOCTYPE html>
<html>
    <head>
        <title>Ogame</title>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

        
        <link rel="stylesheet" href="style/style.css">
        <link rel="stylesheet" href="style/general.css">
        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    </head>
    <body>

      <div class="wrapper">
        <form id="loginform" onsubmit="return false">
          <h1>Register</h1>
          <div class="input-box">
            <input id="username" type="text" placeholder="Username" required>
            <i class='bx bxs-user'></i>
          </div>
          <div class="input-box">
            <input id="password" type="password" placeholder="Password" required>
            <i class='bx bxs-lock-alt'></i>
          </div>
          <div class="input-box">
            <input id="confirmPassword" type="password" placeholder="Confirm Password" required>
            <i class='bx bxs-lock-alt'></i>
          </div>
          
          <input type="submit" value="Register" class="submit" class="btn" onclick="register()" >

        </form>
      </div>
    </body>
    <script>

      var userNameField = document.getElementById("username");
      var passwordField = document.getElementById("password");
      var confirmPasswordField = document.getElementById("confirmPassword");

      async function register()
      {
        var username = userNameField.value;
        var password = passwordField.value;
        var confirmPassword = confirmPasswordField.value;

        if(password === confirmPassword)
        {
          const response = await fetch(`http://127.0.0.1:8080/register?username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`);
          var data = await response.json();

          if(data.success)
          {
            alert("Registrovani ste sa nickom: " + username);

            location.href = 'http://127.0.0.1:5500/login.html';
          }
          else
          {
            alert("Neuspijesna registracija, igrac sa tim imenom vec postoji!");
          }
        }
        else
        {
          alert("Nije vam ista sifra i potvrda sifre! ")
        }
      }

    </script>